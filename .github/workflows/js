- name: Install deps
  run: |
    pip install -r requirements.txt

- name: Run weekly ETL (Friâ†’Thu)
  env:
    JS_KEY_NAME: ${{ secrets.JS_KEY_NAME }}
    JS_API_KEY:  ${{ secrets.JS_API_KEY }}
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  run: |
    python -m sales_core.pipeline --basket "synthethic3.csv" --competitor-url "https://raw.githubusercontent.com/leonelmoreno-cmd/tracking2/main/data/sub-categories2/sub_SYN.csv"

- name: Commit sales CSV
  run: |
    git config user.name "github-actions[bot]"
    git config user.email "github-actions[bot]@users.noreply.github.com"
    git add data/sales/*.csv
    git commit -m "chore(data): refresh weekly sales CSVs"
    git push
